"use strict";var K=Object.defineProperty;var j=(n,e,t)=>e in n?K(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var l=(n,e,t)=>(j(n,typeof e!="symbol"?e+"":e,t),t);const T=require("./chars-6e370533.js"),k=require("@smartmed/utility/consts"),p=0,R=9999;function P(n,e,t){return Number.isNaN(n)||n<=e?e:n>=t?t:Math.round(n)}class y{constructor(e){l(this,"year");this.year=e}static isValidYear(e){return Number.isInteger(e)&&e>=p&&e<=R}static isLeapYear(e){return e%4===0&&(e%100!==0||e%400===0)}static lengthBetween(e,t){return t.year-e.year}static normalizeYearPart(e){return P(e,p,R)}get formattedYear(){return String(this.year).padStart(4,"0")}get isLeapYear(){return y.isLeapYear(this.year)}yearBefore({year:e}){return this.year<e}yearSame({year:e}){return this.year===e}yearSameOrBefore({year:e}){return this.year<=e}yearSameOrAfter({year:e}){return this.year>=e}yearAfter({year:e}){return this.year>e}append({year:e=0}){return new y(this.year+e)}toString(){return this.formattedYear}valueOf(){return this.year}toJSON(){return this.formattedYear}[Symbol.toPrimitive](e){return Date.prototype[Symbol.toPrimitive].call(this,e)}}const Y=0,_=11,A=12;exports.SmedMonthNumber=void 0;(function(n){n[n.January=0]="January",n[n.February=1]="February",n[n.March=2]="March",n[n.April=3]="April",n[n.May=4]="May",n[n.June=5]="June",n[n.July=6]="July",n[n.August=7]="August",n[n.September=8]="September",n[n.October=9]="October",n[n.November=10]="November",n[n.December=11]="December"})(exports.SmedMonthNumber||(exports.SmedMonthNumber={}));class u extends y{constructor(t,r){super(t);l(this,"month");this.month=r}static isValidMonth(t,r){return y.isValidYear(t)&&u.isValidMonthPart(r)}static getMonthDaysCount(t,r){switch(t){case exports.SmedMonthNumber.February:return r?29:28;case exports.SmedMonthNumber.April:case exports.SmedMonthNumber.June:case exports.SmedMonthNumber.September:case exports.SmedMonthNumber.November:return 30;default:return 31}}static currentLocal(){const t=new Date;return new u(t.getFullYear(),t.getMonth())}static currentUtc(){const t=new Date;return new u(t.getUTCFullYear(),t.getUTCMonth())}static lengthBetween(t,r){const s=t.month+t.year*12;return r.month+r.year*12-s}static normalizeMonthPart(t){return P(t,Y,_)}static isValidMonthPart(t){return Number.isInteger(t)&&t>=Y&&t<=_}get formattedMonthPart(){return String(this.month+1).padStart(2,"0")}get daysCount(){return u.getMonthDaysCount(this.month,this.isLeapYear)}monthBefore(t){return this.yearBefore(t)||this.yearSame(t)&&this.month<t.month}monthSameOrBefore(t){return this.yearBefore(t)||this.yearSame(t)&&this.month<=t.month}monthSame(t){return this.yearSame(t)&&this.month===t.month}monthSameOrAfter(t){return this.yearAfter(t)||this.yearSame(t)&&this.month>=t.month}monthAfter(t){return this.yearAfter(t)||this.yearSame(t)&&this.month>t.month}append({year:t=0,month:r=0}){const s=(this.year+t)*A+this.month+r;return new u(Math.floor(s/A),s%A)}toString(){return`${this.formattedMonthPart}.${this.formattedYear}`}valueOf(){return this.toLocalNativeDate().valueOf()}toJSON(){return`${super.toJSON()}-${this.formattedMonthPart}`}toLocalNativeDate(){return new Date(this.year,this.month)}toUtcNativeDate(){return new Date(Date.UTC(this.year,this.month))}}const N=1,E="дд.мм.гггг",L=10;exports.SmedDayOfWeek=void 0;(function(n){n[n.Sunday=0]="Sunday",n[n.Monday=1]="Monday",n[n.Tuesday=2]="Tuesday",n[n.Wednesday=3]="Wednesday",n[n.Thursday=4]="Thursday",n[n.Friday=5]="Friday",n[n.Saturday=6]="Saturday"})(exports.SmedDayOfWeek||(exports.SmedDayOfWeek={}));class c extends u{constructor(t,r,s){super(t,r);l(this,"day");this.day=s}static fromLocalNativeDate(t){return new c(t.getFullYear(),t.getMonth(),t.getDate())}static fromUtcNativeDate(t){return new c(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate())}static isValidDay(t,r,s){return u.isValidMonth(t,r)&&Number.isInteger(s)&&s>=N&&s<=u.getMonthDaysCount(r,y.isLeapYear(t))}static currentLocal(){const t=new Date,r=t.getFullYear(),s=t.getMonth(),a=t.getDate();return new c(r,s,a)}static currentUtc(){const t=new Date,r=t.getUTCFullYear(),s=t.getUTCMonth(),a=t.getUTCDate();return new c(r,s,a)}static normalizeOf(t,r,s){const a=y.normalizeYearPart(t),i=u.normalizeMonthPart(r),o=c.normalizeDayPart(s,i,t);return new c(a,i,o)}static lengthBetween(t,r){return Math.round(r.toLocalNativeDate().getTime()-t.toLocalNativeDate().getTime())/(1e3*60*60*24)}static parseRawDateString(t,r){return r==="DMY"?{day:parseInt(t.slice(0,2),10),month:parseInt(t.slice(3,5),10)-1,year:parseInt(t.slice(6,10),10)}:{day:parseInt(t.slice(8,10),10),month:parseInt(t.slice(5,7),10)-1,year:parseInt(t.slice(0,4),10)}}static normalizeParse(t,r="DMY"){const{day:s,month:a,year:i}=c.parseRawDateString(t,r);return c.normalizeOf(i,a,s)}static jsonParse(t){const{day:r,month:s,year:a}=this.parseRawDateString(t,"YMD");if(!y.isValidYear(a))throw new Error(`Invalid year: ${a}`);if(!u.isValidMonth(a,s))throw new Error(`Invalid month: ${s}`);if(!Number.isInteger(r)||!(r>=N&&r<=u.getMonthDaysCount(s,y.isLeapYear(a))))throw new Error(`Invalid day: ${r}`);return new c(a,s,r)}static normalizeDayPart(t,r,s){const a=u.getMonthDaysCount(r,y.isLeapYear(s));return P(t,N,a)}get formattedDayPart(){return String(this.day).padStart(2,"0")}get isWeekend(){const t=this.dayOfWeek(!1);return t===exports.SmedDayOfWeek.Sunday||t===exports.SmedDayOfWeek.Saturday}dayOfWeek(t=!0){const r=t?this.toLocalNativeDate().getDay()-1:this.toLocalNativeDate().getDay();return r<0?6:r}dayBefore(t){return this.monthBefore(t)||this.monthSame(t)&&this.day<t.day}daySameOrBefore(t){return this.monthBefore(t)||this.monthSame(t)&&this.day<=t.day}daySame(t){return this.monthSame(t)&&this.day===t.day}daySameOrAfter(t){return this.monthAfter(t)||this.monthSame(t)&&this.day>=t.day}dayAfter(t){return this.monthAfter(t)||this.monthSame(t)&&this.day>t.day}dayLimit(t,r){return t!==null&&this.dayBefore(t)?t:r!==null&&this.dayAfter(r)?r:this}append({year:t=0,month:r=0,day:s=0}){const a=(this.year+t)*A+this.month+r;let i=Math.floor(a/A),o=a%A,h=Math.min(this.day,u.getMonthDaysCount(o,y.isLeapYear(i)))+s;for(;h>u.getMonthDaysCount(o,y.isLeapYear(i));)h-=u.getMonthDaysCount(o,y.isLeapYear(i)),o===exports.SmedMonthNumber.December?(i++,o=exports.SmedMonthNumber.January):o++;for(;h<N;)o===exports.SmedMonthNumber.January?(i--,o=exports.SmedMonthNumber.December):o--,h+=u.getMonthDaysCount(o,u.isLeapYear(i));return new c(i,o,h)}getFormattedDay(t,r){const s=this.formattedDayPart,a=this.formattedMonthPart,i=this.formattedYear;switch(t){case"YMD":return`${i}${r}${a}${r}${s}`;default:return`${s}${r}${a}${r}${i}`}}toString(t="DMY",r="."){return this.getFormattedDay(t,r)}toJSON(){return`${super.toJSON()}-${this.formattedDayPart}`}toLocalNativeDate(){return new Date(this.year,this.month,this.day)}toUtcNativeDate(){return new Date(Date.UTC(this.year,this.month,this.day))}}class I{constructor(e,t){l(this,"from");l(this,"to");this.from=e,this.to=t}static sort(e,t){return e.monthSameOrBefore(t)?new I(e,t):new I(t,e)}get isSingleMonth(){return this.from.monthSame(this.to)}monthSame(e){return this.from.monthSame(e.from)&&this.to.monthSame(e.to)}toString(){return`${this.from}${k.CHAR_RANGE_SEPARATOR}${this.to}`}}const Q=`${E}${T.CHAR_RANGE_SEPARATOR}${E}`,v=2*L+T.CHAR_RANGE_SEPARATOR.length;class f extends I{constructor(t,r){super(t,r);l(this,"from");l(this,"to");this.from=t,this.to=r}static sort(t,r){return t.daySameOrBefore(r)?new f(t,r):new f(r,t)}static normalizeParse(t,r="DMY"){const s=c.normalizeParse(t.slice(0,L),r);if(t.length<v)return new f(s,s);const a=c.normalizeParse(t.slice(L+T.CHAR_RANGE_SEPARATOR.length),r);return f.sort(s,a)}get isSingleDay(){return this.from.daySame(this.to)}daySame(t){return this.from.daySame(t.from)&&this.to.daySame(t.to)}dayLimit(t,r){return new f(this.from.dayLimit(t,r),this.to.dayLimit(t,r))}getFormattedDayRange(t,r){const s=this.from.getFormattedDay(t,r),a=this.to.getFormattedDay(t,r);return`${s}${T.CHAR_RANGE_SEPARATOR}${a}`}toString(t="DMY",r="."){return this.getFormattedDayRange(t,r)}}class M{constructor(e,t){l(this,"range");l(this,"name");this.range=e,this.name=t}toString(){return this.name}}const U=new c(p,Y,N),Z=new c(R,_,31);function tt(){const n=c.currentLocal(),e=n.append({day:-1}),t=n.append({day:-n.dayOfWeek()}),r=t.append({day:6}),s=n.append({day:1-n.day}),a=s.append({month:1,day:-1}),i=s.append({month:-1});return[new M(new f(U,n),"За все время"),new M(new f(n,n),"Сегодня"),new M(new f(e,e),"Вчера"),new M(new f(t,r),"Текущая неделя"),new M(new f(s,a),"Текущий месяц"),new M(new f(i,s.append({day:-1})),"Прошлый месяц")]}function et(n,e,t){return t&&t<n?t:e&&e>n?e:n}const B=1e3,b=60,z=60,J=24,S=B*b,g=S*z,$=g*J;class d{constructor(e,t,r=0,s=0){l(this,"hours");l(this,"minutes");l(this,"seconds");l(this,"ms");this.hours=e,this.minutes=t,this.seconds=r,this.ms=s}static currentUtc(){return d.fromAbsoluteMilliseconds(Date.now()%$)}static currentLocal(){const e=new Date,t=(Date.now()-e.getTimezoneOffset()*S)%$;return d.fromAbsoluteMilliseconds(t)}static fromAbsoluteMilliseconds(e){const t=Math.floor(e/g),r=Math.floor(e%g/S),s=Math.floor(e%g%S/1e3)||0,a=Math.floor(e%g%S%1e3)||0;return new d(t,r,s,a)}static fromString(e){const t=Number(e.slice(0,2)),r=Number(e.slice(3,5)),s=Number(e.slice(6,8))||0,a=Number(e.slice(9,12))||0;return new d(t,r,s,a)}static fromLocalNativeDate(e){return new d(e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds())}shift({hours:e=0,minutes:t=0,seconds:r=0,ms:s=0}){const a=(1e3+this.ms+s%1e3)%1e3,o=(s<0?Math.ceil(s/1e3):Math.floor(s/1e3))+r,h=(60+this.seconds+o%60)%60,m=(o<0?Math.ceil(o/60):Math.floor(o/60))+t,X=(60+this.minutes+m%60)%60,x=(m<0?Math.ceil(m/60):Math.floor(m/60))+e,q=(24+this.hours+x%24)%24;return new d(q,X,h,a)}toString(e){const t=e==="HH:MM:SS.MSS"||!e&&this.ms>0,r=t||e==="HH:MM:SS"||!e&&this.seconds>0;return`${this.formatTime(this.hours)}:${this.formatTime(this.minutes)}${r?`:${this.formatTime(this.seconds)}`:""}${t?`.${this.formatTime(this.ms,3)}`:""}`}valueOf(){return this.toAbsoluteMilliseconds()}[Symbol.toPrimitive](e){return Date.prototype[Symbol.toPrimitive].call(this,e)}toAbsoluteMilliseconds(){return this.hours*g+this.minutes*S+this.seconds*1e3+this.ms}formatTime(e,t=2){return String(e).padStart(t,"0")}}const C=", ",rt={"HH:MM":"чч:мм","HH:MM:SS":"чч:мм:сс","HH:MM:SS.MSS":"чч:мм:cc:мсс"},nt=n=>`${E}${C}${rt[n]}`;class w{constructor(e,t){l(this,"day");l(this,"time");this.day=e,this.time=t}static fromString(e,t="DMY"){if(!e||e.length<E.length)return new w(null,null);const[r,s=""]=e.split(C);return new w(c.normalizeParse(r,t),s?d.fromString(s):null)}static jsonParse(e){const t=new Date(e);return new w(c.fromLocalNativeDate(t),d.fromLocalNativeDate(t))}toString(e="DMY",t=".",r="HH:MM"){if(!this.day)return"";const s=this.time?`${C}${this.time.toString(r)}`:"";return`${this.day.toString(e,t)}${s}`}toLocalNativeDate(){if(!this.day)return new Date;const e=this.day.toLocalNativeDate();if(this.time){const{hours:t,minutes:r,seconds:s,ms:a}=this.time;e.setHours(t),e.setMinutes(r),e.setSeconds(s),e.setMilliseconds(a)}return e}toUtcNativeDate(){if(!this.day)return new Date;const e=this.day.toUtcNativeDate();if(this.time){const{hours:t,minutes:r,seconds:s,ms:a}=this.time;e.setUTCHours(t),e.setUTCMinutes(r),e.setUTCSeconds(s),e.setUTCMilliseconds(a)}return e}toJSON(){if(!this.day)return"";const e=this.day.toLocalNativeDate();if(this.time){const{hours:t,minutes:r,seconds:s,ms:a}=this.time;e.setHours(t),e.setMinutes(r),e.setSeconds(s),e.setMilliseconds(a)}return e.toJSON()}}const O=1,F=7;function G(n){const e=new Date(n.year,n.month,1).getDay();return e>=O?e-O:F-(O-e)}function V({month:n,rowIndex:e,colIndex:t}){let r=e*F+t-G(n)+1;return r>n.daysCount&&(r-=n.daysCount,n=n.append({month:1})),r<=0&&(n=n.append({month:-1}),r=n.daysCount+r),new c(n.year,n.month,r)}const st=6;function at(n,e=!1){const t=[];for(let r=0;r<st;r++){const s=[];for(let a=0;a<F;a++){const i=V({month:n,rowIndex:r,colIndex:a}),o=(D,m=n)=>D.year<m.year||D.month<m.month,h=(D,m=n)=>D.year>m.year||D.month>m.month;if(!(o(i)&&!e)){if(h(i)&&!e)break;s.push(i)}}t.push(s)}return t}function H(n){const e=new Date(n);return e.setHours(0),e.setMinutes(0),e.setSeconds(0),e.setMilliseconds(0),e}const ot=(n,e={})=>Intl.DateTimeFormat("ru",e).format(new Date(n));function it(n,e,t){return e.reduce((r,s)=>{const[a,i]=s.replace(/\[|\]/g,"").split(":");let o=ot(n,{[a]:i});if(i==="numeric"&&a!=="day"&&(o=o.length===1?`0${o}`:o),a==="month"&&i==="long"&&t){const h=o[o.length-1];o=h==="ь"||h==="й"?o.slice(0,o.length-1)+"я":o+"а"}return r[s]=o,r},{})}function ct(n,e){if(!n)return null;if(!e)return n?n.toString():null;const t=e.match(/\[\w+:(\w+|2-digit)\]/g);if(!t)return null;const r=e.indexOf("day")>-1,s=it(n,t,r);let a=e;return Object.keys(s).forEach(i=>{a=a.replace(i,s[i])}),a.replace(/\.$/,"")}const ut=1,ht=100;function lt(n,e,t,r=ut,s=ht){const a=[],i=Math.max(n-s,e),o=Math.min(n+s,t);let h=i;for(;h<=o;){const D=[];for(let m=0;m<3&&!(h>o);m++)D.push(h),h+=r;a.push(D)}return a}function yt(n,e){const t=n.getFullYear()<e.getFullYear(),r=n.getFullYear()===e.getFullYear(),s=n.getMonth()<=e.getMonth();return t||r&&s}function W(n,e){return n.getFullYear()===e.getFullYear()&&n.getMonth()===e.getMonth()}function mt(n,e){return W(n,e)&&n.getDate()===e.getDate()}function ft(n,e){return H(n).valueOf()>=H(e).valueOf()}exports.DATE_FILTER_LENGTH=L;exports.DATE_POSTFIX_DECORATOR=E;exports.DATE_RANGE_FILTER_LENGTH=v;exports.DATE_RANGE_POSTFIX_DECORATOR=Q;exports.DAYS_IN_WEEK=F;exports.FIRST_DAY_OF_WEEK=O;exports.HOURS_IN_DAY=J;exports.MAX_MONTH=_;exports.MAX_YEAR=R;exports.MILLISECONDS_IN_DAY=$;exports.MILLISECONDS_IN_HOUR=g;exports.MILLISECONDS_IN_MINUTE=S;exports.MILLISECONDS_IN_SECOND=B;exports.MINUTES_IN_HOUR=z;exports.MIN_DAY=N;exports.MIN_MONTH=Y;exports.MIN_YEAR=p;exports.MONTHS_IN_YEAR=A;exports.SECONDS_IN_MINUTE=b;exports.SMED_DAY_TIME_SEPARATOR=C;exports.SMED_FIRST_DAY=U;exports.SMED_LAST_DAY=Z;exports.SmedDay=c;exports.SmedDayRange=f;exports.SmedDayRangePeriod=M;exports.SmedDayTime=w;exports.SmedMonth=u;exports.SmedMonthRange=I;exports.SmedTime=d;exports.SmedYear=y;exports.createDefaultDayRangePeriod=tt;exports.dateClamp=et;exports.dateTimePostfixDecorator=nt;exports.getDayFromMonthRowCol=V;exports.getDayWithoutTime=H;exports.getDaysRows=at;exports.getFormattedDateByMask=ct;exports.getMonthStartDaysOffset=G;exports.getYearsBetween=lt;exports.isMonthBeforeOrEqual=yt;exports.isSameDay=mt;exports.isSameDayOrBefore=ft;exports.isSameMonth=W;exports.normalizeToIntNumber=P;
