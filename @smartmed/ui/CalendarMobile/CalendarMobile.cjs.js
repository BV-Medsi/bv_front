var me=require("./CalendarMobile.css");const e=require("vue"),E=require("@smartmed/ui/BaseButton"),N=require("@smartmed/ui/Scrollbar"),s=require("@smartmed/utility/date"),$=require("../getDefaultSelectedMonth-12d06072.js"),V=require("../_plugin-vue_export-helper-f246444f.js"),z={value:null,single:!0,max:()=>s.SMED_LAST_DAY,min:()=>s.SMED_FIRST_DAY,disabledDatesHandler:()=>!1},F=["onClick"],j=e.defineComponent({__name:"InternalCalendarMobile",props:{value:{},month:{},single:{type:Boolean},min:{},max:{},disabledDatesHandler:{type:Function}},emits:["select"],setup(g,{emit:r}){const v=g,{month:S,value:f,single:y,min:_,max:C}=e.toRefs(v),u=e.useCssModule(),w=e.computed(()=>s.getDaysRows(S.value)),h=n=>{if(k(n,_.value,C.value))return;if(y.value){r("select",n);return}const l=f.value;if(l===null){r("select",n);return}if(l instanceof s.SmedDay){r("select",s.SmedDayRange.sort(l,n));return}r("select",n)},c=s.SmedDay.currentLocal(),p=(n,l)=>n instanceof s.SmedDay?n.daySame(l):n.from.daySame(l)||n.to.daySame(l),D=(n,l)=>n instanceof s.SmedDayRange?n.from.dayBefore(l)&&n.to.dayAfter(l):!1,k=(n,l,i)=>n.dayBefore(l)||n.dayAfter(i)||v.disabledDatesHandler(n),B=n=>{const l=[],i=n.daySame(c),d=f.value;return i&&l.push(u.dateCell_now),d&&p(d,n)&&l.push(u.dateCell_selected),d&&D(d,n)&&l.push(u.dateCell_range),k(n,_.value,C.value)&&l.push(u.dateCell_disabled),l};return(n,l)=>(e.openBlock(),e.createElementBlock("div",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(w.value,(i,d)=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:d},[i.length?(e.openBlock(),e.createElementBlock("div",{key:0,class:e.normalizeClass(n.$style.dateRow)},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(i,m=>(e.openBlock(),e.createElementBlock("div",{key:m.valueOf(),class:e.normalizeClass([n.$style.dateCell,B(m)]),onClick:b=>h(m)},e.toDisplayString(m.day),11,F))),128))],2)):e.createCommentVNode("",!0)],64))),128))]))}}),T="_dateRow_gvj41_1",Y="_dateCell_gvj41_11",q="_dateCell_now_gvj41_26",L="_dateCell_range_gvj41_29",H="_dateCell_selected_gvj41_33",A="_dateCell_disabled_gvj41_37",I={dateRow:T,dateCell:Y,dateCell_now:q,dateCell_range:L,dateCell_selected:H,dateCell_disabled:A},O={$style:I},P=V._export_sfc(j,[["__cssModules",O]]),G={class:"smed-text_body-xl smed-text_medium"},J=["id","onClick"],K=["id"],Q=e.defineComponent({__name:"CalendarMobile",props:e.mergeDefaults({value:{},single:{type:Boolean},min:{},max:{},actionsFixed:{type:Boolean},disabledDatesHandler:{type:Function}},z),emits:["confirm","cancel"],setup(g,{emit:r}){const v=g,{value:S,single:f,min:y,max:_}=e.toRefs(v),C=e.ref(null),u=e.ref(null),w=["Пн","Вт","Ср","Чт","Пт","Сб","Вс"],h=s.SmedDay.currentLocal(),c=e.ref($.getDefaultSelectedMonth(y.value,_.value)),p=e.ref($.getDefaultSelectedMonth(y.value,_.value)),D=e.computed(()=>{var t;return((t=C.value)==null?void 0:t.native)||null}),k=e.computed(()=>{var t;return((t=u.value)==null?void 0:t.native)||null}),B=[].concat(...s.getYearsBetween(h.year,h.append({year:-100}).year,h.append({year:100}).year,1,200)),n=e.ref(v.value||null),l=e.computed(()=>{const t=[],o=c.value.year;for(let a=0;a<s.MONTHS_IN_YEAR;a++)t.push(new s.SmedMonth(o,a));return t}),i={0:"Январь",1:"Февраль",2:"Март",3:"Апрель",4:"Май",5:"Июнь",6:"Июль",7:"Август",8:"Сентябрь",9:"Октябрь",10:"Ноябрь",11:"Декабрь"},d=t=>{n.value=t},m=t=>{c.value=new s.SmedYear(t),p.value=new s.SmedMonth(t,p.value.month)},b=()=>{const t=n.value;f.value?t instanceof s.SmedDayRange?r("confirm",t.from):r("confirm",t):t instanceof s.SmedDay?r("confirm",new s.SmedDayRange(t,t)):r("confirm",t)},M=()=>{r("cancel")},R=([t,o])=>{if(o){const a=o.querySelector(`#month_${t.month}`);o.scrollTo({top:a.offsetTop})}},x=([t,o])=>{if(o){const a=o.querySelector(`#year_${t.year}`);a==null||a.scrollIntoView({block:"center",inline:"center"})}};return e.watch(S,t=>{n.value=t;const o=t instanceof s.SmedDayRange?t.from:t,a=$.getDefaultMonth(o,y.value,_.value);c.value=a,p.value=a},{immediate:!0}),e.watch([p,D],R),e.watch([c,k],x),(t,o)=>(e.openBlock(),e.createElementBlock("div",null,[e.createElementVNode("div",{class:e.normalizeClass(t.$style.header)},[e.createElementVNode("span",G," Выберите "+e.toDisplayString(e.unref(f)?"день":"период"),1)],2),e.createVNode(e.unref(N),{ref_key:"yearsScrollbar",ref:u,class:e.normalizeClass(t.$style.years)},{default:e.withCtx(()=>[e.createElementVNode("div",{class:e.normalizeClass(t.$style.years__container)},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(B),a=>(e.openBlock(),e.createElementBlock("button",{id:`year_${a}`,key:a,class:e.normalizeClass([t.$style.years__item,(c.value.year===a-1||c.value.year===a+1)&&t.$style.years__item_adjacent,c.value.year===a&&t.$style.years__item_active]),onClick:ue=>m(a)},e.toDisplayString(a),11,J))),128))],2)]),_:1},8,["class"]),e.createElementVNode("div",{class:e.normalizeClass(t.$style.weeks)},[(e.openBlock(),e.createElementBlock(e.Fragment,null,e.renderList(w,a=>e.createElementVNode("div",{key:a,class:e.normalizeClass(t.$style.weeks__item)},e.toDisplayString(a),3)),64))],2),e.createVNode(e.unref(N),{ref_key:"monthsScrollbar",ref:C,class:e.normalizeClass(t.$style.months)},{default:e.withCtx(()=>[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(l.value,a=>(e.openBlock(),e.createElementBlock("section",{id:`month_${a.month}`,key:a.month},[e.createElementVNode("h2",{class:e.normalizeClass(["smed-text_h4 smed-text_medium smed-space_vertical-2",t.$style.name])},e.toDisplayString(i[a.month]),3),e.createVNode(P,{value:n.value,month:a,class:e.normalizeClass(t.$style.calendar),single:e.unref(f),min:e.unref(y),max:e.unref(_),"disabled-dates-handler":t.disabledDatesHandler,onSelect:d},null,8,["value","month","class","single","min","max","disabled-dates-handler"])],8,K))),128))]),_:1},8,["class"]),e.createElementVNode("div",{class:e.normalizeClass([t.$style.actions,t.actionsFixed&&t.$style.actions_fixed])},[e.createVNode(e.unref(E),{onClick:b},{default:e.withCtx(()=>[e.createTextVNode(" Подтвердить ")]),_:1}),e.createVNode(e.unref(E),{color:"secondaryOutlined",class:"smed-space_top-1",onClick:M},{default:e.withCtx(()=>[e.createTextVNode(" Отменить ")]),_:1})],2)]))}}),U="_header_18eao_1",W="_name_18eao_6",X="_calendar_18eao_10",Z="_years_18eao_15",ee="_years__container_18eao_19",te="_years__item_18eao_23",ne="_years__item_adjacent_18eao_40",ae="_years__item_active_18eao_45",le="_weeks_18eao_51",se="_weeks__item_18eao_59",oe="_months_18eao_67",re="_actions_18eao_72",ce="_actions_fixed_18eao_78",ie={header:U,name:W,calendar:X,years:Z,years__container:ee,years__item:te,years__item_adjacent:ne,years__item_active:ae,weeks:le,weeks__item:se,months:oe,actions:re,actions_fixed:ce},de={$style:ie},_e=V._export_sfc(Q,[["__cssModules",de]]);module.exports=_e;
