var st=require("./Tooltip.css");const t=require("vue"),N=require("@smartmed/ui/ActiveZone"),V=require("@smartmed/ui/Portal"),L=require("@smartmed/ui/tokens"),S=require("@smartmed/utility/directives"),M=require("@smartmed/utility/vue"),W=require("../_plugin-vue_export-helper-f246444f.js"),Z={direction:"bottom-right"},n=4,x=7,D=x*5,Y={"top-left":"bottom-left","top-right":"bottom-right","bottom-left":"top-left","bottom-right":"top-right",left:"right",right:"left","top-middle":"bottom-middle","bottom-middle":"top-middle"},j={"top-left":"top-right","top-right":"top-left","bottom-left":"bottom-right","bottom-right":"bottom-left",left:"right",right:"left","top-middle":"top-middle","bottom-middle":"bottom-middle"};function K(l,a,s,b){let r=b;const w=l.top+l.height/2-a.height/2-s.top,T=l.left-a.width-n-s.left,u=l.left+l.width+n-s.left,d=l.bottom+n-s.top,c=l.top-a.height-n-s.top,f=l.left+l.width/2-D-s.left,_=l.left+l.width/2-a.width+D-s.left,v=l.left-a.width/2+l.width/2-s.left,h=["left","right","bottom-left","bottom-right","bottom-middle","top-left","top-right","top-middle"];h.splice(h.indexOf(r),1);let i=0,o=0;for(;h.length;){switch(r){case"left":i=w,o=T-n*2;break;case"right":i=w,o=u+n*2;break;case"top-right":i=c-n*2,o=f;break;case"top-left":i=c-n*2,o=_;break;case"bottom-right":i=d+n*2,o=f;break;case"bottom-left":i=d+n*2,o=_;break;case"bottom-middle":i=d+n*2,o=v;break;case"top-middle":i=c-n*2,o=v;break}const k=i+s.top>n&&i+a.height+n+s.top<window.innerHeight,y=o>n&&o+a.width+n+s.left<s.width;if(h.length===0||k&&y)break;r=k?j[r]:Y[r],r=h.splice(h.indexOf(r),1)[0]||b}return{left:o,top:i,direction:r}}const U=["aria-describedby"],G={name:"Tooltip"},J=t.defineComponent({...G,props:t.mergeDefaults({direction:{},describedBy:{},wide:{type:Boolean}},Z),setup(l){const a=l,s=500,b=200,{direction:r}=t.toRefs(a),w=t.useSlots(),T=t.inject(L.HINT_HOST_TOKEN),u=t.ref(null),d=t.ref(null),c=t.ref(!1),f=t.ref(null),_=t.ref(null),v=t.ref(r.value),h=t.ref({left:0,top:0}),i={id:null},o=t.computed(()=>M.hasSlotContent(w.hint)),k=()=>T?T.value.getBoundingClientRect():{left:0,top:document.body.clientHeight,width:document.body.clientWidth},y=e=>{if(!o.value){g(),p();return}e?(C(),g()):(p(),H())},E=e=>{o.value&&(e?(C(),g()):(p(),H()))},A=e=>{!c.value||!o.value||(e?g():(p(),H()))},C=()=>{c.value||!o.value||(u.value=setTimeout(()=>{c.value=!0,u.value=null},s))},p=()=>{u.value&&(clearTimeout(u.value),u.value=null)},H=()=>{!c.value||!o.value||(d.value=setTimeout(()=>{c.value=!1,d.value=null},b))},g=()=>{d.value&&(clearTimeout(d.value),d.value=null)},$=t.computed(()=>{const{left:e,top:m}=h.value;return{left:`${e}px`,top:`${m}px`}});t.onBeforeUnmount(()=>{p(),g(),B()});const O=()=>{if(!f.value||!_.value)return;const e=f.value.getBoundingClientRect(),m=_.value.getBoundingClientRect(),q=k(),{direction:z,left:I,top:F}=K(e,m,q,r.value);h.value={left:I,top:F},v.value=z},P=()=>{const e=()=>{O(),i.id=requestAnimationFrame(e)};i.id=requestAnimationFrame(e)},B=()=>{i.id&&cancelAnimationFrame(i.id)};return t.watch([c,o],([e,m])=>{e&&m?P():B()}),(e,m)=>t.withDirectives((t.openBlock(),t.createBlock(t.unref(N),{class:t.normalizeClass([e.$style.host,e.wide&&e.$style.host_wide]),onActiveZoneChanged:y},{default:t.withCtx(()=>[t.createElementVNode("div",{ref_key:"host",ref:f,class:t.normalizeClass(e.$style.container)},[t.renderSlot(e.$slots,"default")],2),o.value?(t.openBlock(),t.createBlock(t.unref(V),{key:0,"append-to":"#smed_hints-host"},{default:t.withCtx(()=>[t.createVNode(t.Transition,{name:"fade"},{default:t.withCtx(()=>[c.value?t.withDirectives((t.openBlock(),t.createElementBlock("div",{key:0,ref_key:"hint",ref:_,class:t.normalizeClass([e.$style.hint,e.$style["hint_"+v.value]]),"aria-describedby":e.describedBy,style:t.normalizeStyle($.value)},[t.renderSlot(e.$slots,"hint")],14,U)),[[t.unref(S.HoveredDirective),{onEvent:A}]]):t.createCommentVNode("",!0)]),_:3})]),_:3})):t.createCommentVNode("",!0)]),_:3},8,["class"])),[[t.unref(S.HoveredDirective),{onEvent:E}]])}}),Q="_host_2h2o8_1",X="_host_wide_2h2o8_5",R="_container_2h2o8_8",tt="_hint_2h2o8_16",et="_hint_left_2h2o8_33",ot="_hint_right_2h2o8_38",it={host:Q,host_wide:X,container:R,hint:tt,hint_left:et,hint_right:ot,"hint_bottom-left":"_hint_bottom-left_2h2o8_43","hint_bottom-right":"_hint_bottom-right_2h2o8_47","hint_bottom-middle":"_hint_bottom-middle_2h2o8_51","hint_top-left":"_hint_top-left_2h2o8_56","hint_top-right":"_hint_top-right_2h2o8_61","hint_top-middle":"_hint_top-middle_2h2o8_66"},nt={$style:it},lt=W._export_sfc(J,[["__cssModules",nt]]);module.exports=lt;
