var se=require("./ScrollbarControllers.css");const e=require("vue"),S=require("@smartmed/ui/tokens"),W=require("@smartmed/utility/functions"),b=require("../scrollbarTokens-475d4523.js"),x=require("../_plugin-vue_export-helper-f246444f.js"),p=24,U=1e3/15,H=e.defineComponent({__name:"ScrollbarThumb",props:{direction:{default:"vertical"}},setup(E){const u=E,{direction:r}=e.toRefs(u),s=e.ref(null),d=e.inject(b.SCROLLBAR_WRAPPER_TOKEN),i=e.inject(b.SCROLLBAR_REF_TOKEN,null),w=e.inject(S.ANIMATION_FRAME_EVENTS_TOKEN),v=e.computed(()=>i&&i.value||document.documentElement),c=e.computed(()=>i&&i.value||window),_=()=>{const t=v.value,{clientHeight:o,scrollHeight:n,clientWidth:l,scrollWidth:a}=t;return o*o/n>p&&r.value==="vertical"||l*l/a>p&&r.value==="horizontal"?0:r.value==="vertical"?p/o:p/l},h=()=>{const t=v.value,{clientHeight:o,scrollHeight:n,clientWidth:l,scrollWidth:a}=t;return r.value==="vertical"?Math.ceil(o/n*100)/100:Math.ceil(l/a*100)/100},L=()=>{const t=v.value,{scrollTop:o,scrollHeight:n,clientHeight:l,scrollLeft:a,scrollWidth:m,clientWidth:R}=t;return r.value==="vertical"?o/(n-l):a/(m-R)},k=()=>{const t=_()||h();return L()*(1-t)},T=()=>{const t=s.value;t&&(u.direction==="vertical"?(t.style.top=`${k()*100}%`,t.style.height=`${h()*100}%`):(t.style.left=`${k()*100}%`,t.style.width=`${h()*100}%`))},g=({clientY:t,clientX:o},n,l)=>{if(!s.value||!d.value)return[0,0];const{offsetHeight:a,offsetWidth:m}=s.value,{top:R,left:F,width:M,height:$}=d.value.getBoundingClientRect(),K=v.value.scrollHeight-$,P=v.value.scrollWidth-M,j=(t-R-a*n)/($-a),q=(o-F-m*l)/(M-m);return[K*j,P*q]};let z=0,N=0;const A=({clientY:t},{top:o,height:n})=>(t-o)/n,V=({clientX:t},{left:o,width:n})=>(t-o)/n,C=()=>{document.removeEventListener("mousemove",f)},f=t=>{const[o,n]=g(t,z,N),l=i&&i.value;if(!l){const{scrollX:a,scrollY:m}=window;window.scrollTo(r.value==="vertical"?a:n,r.value==="vertical"?o:m);return}u.direction==="vertical"?l.scrollTop=o:l.scrollLeft=n},y=t=>{if(t.preventDefault(),t.stopPropagation(),!s.value)return;const o=s.value.getBoundingClientRect();z=A(t,o),N=V(t,o),document.removeEventListener("mousemove",f),document.removeEventListener("mouseup",C),document.addEventListener("mousemove",f),document.addEventListener("mouseup",C)},B=t=>{t.preventDefault();const o=i&&i.value,[n,l]=g(t,.5,.5);if(!o){const{scrollX:a,scrollY:m}=window;window.scrollTo(r.value==="vertical"?a:l,r.value==="vertical"?n:m);return}u.direction==="vertical"?o.scrollTop=n:o.scrollLeft=l},D=()=>{var t,o;c.value.addEventListener("scroll",T),(t=s.value)==null||t.addEventListener("mousedown",y),(o=d.value)==null||o.addEventListener("mousedown",B)};e.onBeforeUnmount(()=>{var t,o;c.value.removeEventListener("scroll",T),(t=s.value)==null||t.removeEventListener("mousedown",y),(o=d.value)==null||o.removeEventListener("mousedown",B),document.removeEventListener("mousemove",f),document.removeEventListener("mouseup",C)});const I=W.useThrottleFn(T,U);return e.watch(w,I,{immediate:!0}),e.watch([d,s],(t,o)=>{t&&o&&D()},{immediate:!0}),(t,o)=>(e.openBlock(),e.createElementBlock("div",{ref_key:"thumbRef",ref:s},null,512))}}),O=e.defineComponent({__name:"ScrollbarWrapper",setup(E){const u=e.ref(null);return e.provide(b.SCROLLBAR_WRAPPER_TOKEN,u),(r,s)=>(e.openBlock(),e.createElementBlock("div",{ref_key:"wrapper",ref:u},[e.renderSlot(r.$slots,"default")],512))}}),X={name:"ScrollbarControllers"},Y=e.defineComponent({...X,setup(E){const u=e.inject(S.ANIMATION_FRAME_EVENTS_TOKEN),r=e.inject(b.SCROLLBAR_REF_TOKEN,null),s=e.ref(!1),d=e.ref(!1),i=e.computed(()=>r&&r.value||document.documentElement),w=()=>{const{clientHeight:c,scrollHeight:_,clientWidth:h,scrollWidth:L}=i.value;s.value=Math.ceil(c/_*100)<100,d.value=Math.ceil(h/L*100)<100},v=W.useThrottleFn(w,300);return e.watch(u,v,{immediate:!0}),(c,_)=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(c.$style.root)},[e.createVNode(e.Transition,{name:"fade"},{default:e.withCtx(()=>[s.value?(e.openBlock(),e.createBlock(O,{key:0,class:e.normalizeClass([c.$style.bar,c.$style.bar_vertical,d.value&&c.$style.bar_hashorizontal])},{default:e.withCtx(()=>[e.createVNode(H,{direction:"vertical",class:e.normalizeClass(c.$style.thumb)},null,8,["class"])]),_:1},8,["class"])):e.createCommentVNode("",!0)]),_:1}),e.createVNode(e.Transition,{name:"fade"},{default:e.withCtx(()=>[d.value?(e.openBlock(),e.createBlock(O,{key:0,class:e.normalizeClass([c.$style.bar,c.$style.bar_horizontal,s.value&&c.$style.bar_hasvertical])},{default:e.withCtx(()=>[e.createVNode(H,{direction:"horizontal",class:e.normalizeClass(c.$style.thumb)},null,8,["class"])]),_:1},8,["class"])):e.createCommentVNode("",!0)]),_:1})],2))}}),G="_root_bsokn_1",J="_bar_bsokn_17",Q="_bar_vertical_bsokn_23",Z="_bar_horizontal_bsokn_27",ee="_bar_hashorizontal_bsokn_31",te="_bar_hasvertical_bsokn_34",oe="_thumb_bsokn_38",ne={root:G,bar:J,bar_vertical:Q,bar_horizontal:Z,bar_hashorizontal:ee,bar_hasvertical:te,thumb:oe},le={$style:ne},re=x._export_sfc(Y,[["__cssModules",le]]);module.exports=re;
