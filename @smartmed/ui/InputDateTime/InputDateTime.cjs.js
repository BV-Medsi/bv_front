var ce=require("./InputDateTime.css");const o=require("vue"),Y=require("@maskito/kit"),W=require("@smartmed/ui/BaseInput"),j=require("@smartmed/ui/Calendar"),K=require("@smartmed/ui/DropdownHost"),J=require("@smartmed/ui/SvgIcon"),Q=require("@smartmed/ui/TimePicker"),X=require("@smartmed/ui/tokens"),f=require("@smartmed/ui/use"),n=require("@smartmed/utility/date"),V=require("../hasSlotContent-34be92f3.js"),Z=require("../BaseInput.props-4886ef7a.js"),ee=require("../_plugin-vue_export-helper-f246444f.js"),oe={...Z.BaseInputDefaultProps,hasCleaner:!0,inputmode:"numeric",placeholder:"",timeMode:"HH:MM",dropdownProps:()=>({}),calendarProps:()=>({}),min:()=>n.SMED_FIRST_DAY,max:()=>n.SMED_LAST_DAY},te=o.defineComponent({name:"InputDateTime",__name:"InputDateTime",props:o.mergeDefaults({modelValue:{},modelModifiers:{},type:{},size:{},disabled:{type:Boolean},label:{},description:{},editable:{type:Boolean},isError:{type:Boolean},isSuccess:{type:Boolean},placeholder:{},autocomplete:{},name:{},hasCleaner:{type:Boolean},decoratorPostfix:{},decoratorPostfixColorClass:{},inputmode:{},readonly:{type:Boolean},stringify:{type:Function},id:{},dataAutomationId:{},pseudoHovered:{type:Boolean},pseudoFocused:{type:Boolean},inputStyles:{},rightSlotPadding:{},max:{},min:{},timeMode:{},dropdownProps:{},calendarProps:{}},oe),emits:["update:modelValue"],setup(w,{emit:r}){const v=w,{modelValue:s,disabled:x,isError:g,max:y,min:h,placeholder:E,timeMode:l}=o.toRefs(v),d=o.ref(!1),m=o.ref(null),I=o.computed(()=>{var e;return((e=m.value)==null?void 0:e.wrapper)??null}),c=e=>(e==null?void 0:e.toString(void 0,void 0,l.value))||"",u=o.ref(c(s.value));o.provide(X.DROPDOWN_HOST_PIVOT_TOKEN,I);const _=o.useSlots(),D=f.useControlAccess(null),k=f.useControlInvalid(g),T=f.useControlDisabled(x),M=o.computed(()=>{var e;return((e=m.value)==null?void 0:e.focused)||!1}),S=o.computed(()=>266+(l.value==="HH:MM"?200:300)),N=o.computed(()=>V.hasSlotContent(_.label)),b=o.computed(()=>V.hasSlotContent(_.description)),q=o.computed(()=>{const e=E.value;if(e)return e;const t=l.value;return n.dateTimePostfixDecorator(t)}),A=o.computed(()=>{const e=u.value;return M.value?n.dateTimePostfixDecorator(l.value).slice(e.length):""}),B=o.computed(()=>{const e=y.value.toLocalNativeDate(),t=h.value.toLocalNativeDate(),a=l.value;return Y.maskitoDateTimeOptionsGenerator({dateMode:"dd/mm/yyyy",timeMode:a,dateSeparator:".",max:e,min:t})}),L=o.computed(()=>{const e=s.value;return e?e.day:null}),C=o.computed(()=>{const e=y.value;return(e instanceof n.SmedDayTime?e.day:e)||void 0}),P=o.computed(()=>{const e=h.value;return(e instanceof n.SmedDayTime?e.day:e)||void 0}),H=o.computed(()=>{const e=s.value;return e?e.time:null}),F=e=>{const t=e;if(u.value=t,!t){r("update:modelValue",null);return}if(t.length>=n.DATE_FILTER_LENGTH){const a=n.SmedDay.normalizeParse(t),i=l.value,G=n.dateTimePostfixDecorator(i).length;if(t.length===G){const p=t.slice(n.DATE_FILTER_LENGTH+n.SMED_DAY_TIME_SEPARATOR.length),U=new n.SmedDayTime(a,n.SmedTime.fromString(p));r("update:modelValue",U)}else{const p=new n.SmedDayTime(a,null);r("update:modelValue",p)}}},z=e=>{const t=s.value,a=t?t.time:null,i=new n.SmedDayTime(e,a);r("update:modelValue",i),d.value=!1},R=e=>{const t=s.value;if(t&&t.time===null&&!e.hours&&!e.minutes&&!e.seconds)return;const a=t?t.day:null,i=new n.SmedDayTime(a||n.dateClamp(n.SmedDay.currentLocal(),P.value,C.value),e);r("update:modelValue",i)},$=()=>{r("update:modelValue",null),d.value=!0};o.watch(d,e=>{!e&&D&&D.markAsTouch()});const O=(e,t)=>t?!e||e.time===null&&e.day===null?t==="":e.time===null?c(e.day)===t.slice(0,n.DATE_FILTER_LENGTH):e.time&&e.day?c(e)===t:!1:e===null||e.time===null&&e.day===null;return o.watch(s,e=>{O(e,u.value)||(u.value=c(e))}),(e,t)=>(o.openBlock(),o.createBlock(o.unref(K),o.mergeProps(e.dropdownProps,{modelValue:d.value,"onUpdate:modelValue":t[0]||(t[0]=a=>d.value=a),class:e.$style.idthost,"max-width":S.value,"min-width":S.value,"min-height":318,"can-open":!o.unref(T)}),{dropdown:o.withCtx(()=>[o.createElementVNode("div",{class:o.normalizeClass(e.$style.dropdown)},[o.createVNode(o.unref(j),o.mergeProps(e.calendarProps,{"show-adjacent-days":"",max:C.value,min:P.value,value:L.value,onDayClick:z}),null,16,["max","min","value"]),o.createElementVNode("div",{class:o.normalizeClass(e.$style.timePicker)},[o.createVNode(o.unref(Q),{mode:o.unref(l),"model-value":H.value,"onUpdate:modelValue":R},null,8,["mode","model-value"])],2)],2)]),default:o.withCtx(()=>[o.createVNode(o.unref(W),o.mergeProps(v,{ref_key:"baseInputExposed",ref:m,disabled:o.unref(T),"model-value":u.value,"is-error":o.unref(k),"pseudo-focused":d.value,"mask-options":B.value,placeholder:q.value,"decorator-postfix":A.value,"decorator-postfix-color-class":e.$style.idtdecorator,onSearchClear:$,"onUpdate:modelValue":F}),{right:o.withCtx(()=>[o.createVNode(o.unref(J),{name:"calendar",class:o.normalizeClass(e.$style.idticon),size:e.size==="sm"?"md":"lg"},null,8,["class","size"])]),label:o.withCtx(()=>[N.value?o.renderSlot(e.$slots,"label",{key:0}):o.createCommentVNode("",!0)]),description:o.withCtx(()=>[b.value?o.renderSlot(e.$slots,"description",{key:0}):o.createCommentVNode("",!0)]),_:3},16,["disabled","model-value","is-error","pseudo-focused","mask-options","placeholder","decorator-postfix","decorator-postfix-color-class"])]),_:3},16,["modelValue","class","max-width","min-width","can-open"]))}}),ne="_idthost_1l4h0_1",ae="_idticon_1l4h0_5",le="_idtdecorator_1l4h0_13",re="_dropdown_1l4h0_17",se="_timePicker_1l4h0_21",de={idthost:ne,idticon:ae,idtdecorator:le,dropdown:re,timePicker:se},ue={$style:de},ie=ee._export_sfc(te,[["__cssModules",ue]]);module.exports=ie;
