var Ie=require("./Calendar.css");const t=require("vue"),M=require("@smartmed/ui/BaseButton"),U=require("@smartmed/ui/Scrollbar"),r=require("@smartmed/utility/date"),E=require("../getDefaultSelectedMonth-12d06072.js"),W=require("../_plugin-vue_export-helper-f246444f.js"),X={value:null,showAdjacentDays:!1,hoveredItem:null,minViewedMonth:()=>r.SMED_FIRST_DAY,maxViewedMonth:()=>r.SMED_LAST_DAY,min:()=>r.SMED_FIRST_DAY,max:()=>r.SMED_LAST_DAY,disabledDatesHandler:()=>!1},Z={"data-automation-id":"smed-calendar__month-name",class:"smed-space_right-1"},x=["onMouseenter","onClick"],ee=["id","onClick"],te=t.defineComponent({name:"Calendar",__name:"Calendar",props:t.mergeDefaults({value:{},showAdjacentDays:{type:Boolean},min:{},max:{},month:{},maxViewedMonth:{},minViewedMonth:{},hoveredItem:{},disabledDatesHandler:{type:Function}},X),emits:["dayClick","update:month","update:hoveredItem"],setup($,{emit:c}){const h=$,{value:u,showAdjacentDays:p,min:d,max:i,month:m,maxViewedMonth:I,minViewedMonth:V,hoveredItem:k}=t.toRefs(h),f=t.useCssModule(),_=t.ref(!1),l=t.ref(E.getDefaultMonth((m==null?void 0:m.value)||null,d.value,i.value)),w=t.ref(null),b=["Пн","Вт","Ср","Чт","Пт","Сб","Вс"],A={0:"январь",1:"февраль",2:"март",3:"апрель",4:"май",5:"июнь",6:"июль",7:"август",8:"сентябрь",9:"октябрь",10:"ноябрь",11:"декабрь"},z=r.SmedDay.currentLocal(),R=t.computed(()=>r.getDaysRows(l.value,p.value)),N=t.computed(()=>{const e=l.value.year,a=d.value.year,n=i.value.year;return r.getYearsBetween(e,a,n)}),Y=t.computed(()=>{const e=l.value.month;return A[e]}),y=t.computed(()=>{const e=V.value,a=d.value;return e.monthSameOrAfter(a)?e:a}),v=t.computed(()=>{const e=I.value,a=i.value;return e.monthSameOrBefore(a)?e:a}),D=t.computed(()=>{const e=l.value,a=y.value;return e.monthAfter(a)}),g=t.computed(()=>{const e=v.value;return l.value.monthBefore(e)}),F=()=>{if(!D.value)return;const e=l.value;l.value=r.dateClamp(e.append({month:-1}),y.value,v.value),c("update:month",l.value)},H=()=>{if(!g.value)return;const e=l.value;l.value=r.dateClamp(e.append({month:1}),y.value,v.value),c("update:month",l.value)},B=e=>{e&&C(e)||c("update:hoveredItem",e)},L=(e,a)=>{if(!a)return!1;if(a instanceof r.SmedDay)return e.daySame(a);const{from:n,to:s}=a;return n.daySame(e)||s.daySame(e)},j=e=>e.daySame(z),q=e=>{C(e)||c("dayClick",e)},O=()=>{_.value=!0},T=e=>z.year===e,P=e=>{l.value=r.dateClamp(new r.SmedMonth(e,l.value.month),y.value,v.value),_.value=!1,c("update:month",l.value)},G=(e,a)=>e===a.year,C=e=>{const a=d.value,n=i.value;return e.dayBefore(a)||e.dayAfter(n)||h.disabledDatesHandler(e)},J=e=>{const a=u.value;if(!a||a instanceof r.SmedDay)return!1;if(!a.isSingleDay)return a.from.daySameOrBefore(e)&&a.to.daySameOrAfter(e);const n=k.value;if(n===null)return!1;const s=r.SmedDayRange.sort(a.from,n);return s.from.daySameOrBefore(e)&&s.to.daySameOrAfter(e)},K=e=>{const a=u.value;if(!a)return null;if(a instanceof r.SmedDay)return a.daySame(e)?"single":null;const n=k.value;return a.from.daySame(e)&&!a.isSingleDay||(n==null?void 0:n.dayAfter(a.from))&&a.from.daySame(e)&&a.isSingleDay||(n==null?void 0:n.daySame(e))&&n.dayBefore(a.from)&&a.isSingleDay?"start":a.to.daySame(e)&&!a.isSingleDay||(n==null?void 0:n.dayBefore(a.from))&&a.from.daySame(e)&&a.isSingleDay||(n==null?void 0:n.daySame(e))&&n.dayAfter(a.from)&&a.isSingleDay?"end":a.isSingleDay&&a.from.daySame(e)?"single":null},Q=e=>{switch(K(e)){case"single":return f.dateCell_intervalSingle;case"start":return f.dateCell_intervalStart;case"end":return f.dateCell_intervalEnd}};return t.watch(w,e=>{if(e&&e.native){const a=l.value.year,n=e.native.querySelector(`#smed_year_picker_${a}`);n&&n.scrollIntoView({block:"center"})}}),m&&t.watch(m,e=>{l.value=E.getDefaultMonth(e||null,d.value,i.value)}),t.watch(u,e=>{p.value&&e instanceof r.SmedDay&&(l.value=e)},{immediate:!0}),(e,a)=>(t.openBlock(),t.createElementBlock("div",{class:t.normalizeClass([e.$style.container,_.value&&e.$style.container_overflow])},[_.value?(t.openBlock(),t.createBlock(t.unref(U),{key:1,ref_key:"yearContainer",ref:w,"data-automation-id":"smed-calendar__year-scrollbar",class:t.normalizeClass(e.$style.yearContainer)},{default:t.withCtx(()=>[(t.openBlock(!0),t.createElementBlock(t.Fragment,null,t.renderList(N.value,(n,s)=>(t.openBlock(),t.createElementBlock("div",{key:s,class:t.normalizeClass(e.$style.yearRow)},[(t.openBlock(!0),t.createElementBlock(t.Fragment,null,t.renderList(n,o=>(t.openBlock(),t.createElementBlock("span",{id:"smed_year_picker_"+o,key:o,"data-automation-id":"smed-calendar__year-picker",class:t.normalizeClass([e.$style.yearItem,T(o)&&e.$style.yearItem_current,G(o,l.value)&&e.$style.yearItem_selected]),onClick:S=>P(o)},t.toDisplayString(o),11,ee))),128))],2))),128))]),_:1},8,["class"])):(t.openBlock(),t.createElementBlock(t.Fragment,{key:0},[t.createElementVNode("div",{class:t.normalizeClass(e.$style.monthContainer)},[t.createVNode(t.unref(M),{color:"outlined","data-automation-id":"smed-calendar__month-button-left",size:"sm",icon:"arrow-left",class:t.normalizeClass(!D.value&&e.$style.buttonHidden),onClick:F},null,8,["class"]),t.createElementVNode("div",{class:t.normalizeClass(e.$style.month)},[t.createElementVNode("span",Z,t.toDisplayString(Y.value),1),t.createElementVNode("span",{"data-automation-id":"smed-calendar__year",class:t.normalizeClass(e.$style.year),onClick:O},t.toDisplayString(l.value.year),3)],2),t.createVNode(t.unref(M),{color:"outlined","data-automation-id":"smed-calendar__month-button-right",size:"sm",icon:"arrow-right",class:t.normalizeClass(!g.value&&e.$style.buttonHidden),onClick:H},null,8,["class"])],2),t.createElementVNode("div",{class:t.normalizeClass(e.$style.weekdays)},[(t.openBlock(),t.createElementBlock(t.Fragment,null,t.renderList(b,n=>t.createElementVNode("span",{key:n,"data-automation-id":"smed-calendar__weekday",class:t.normalizeClass(e.$style.date)},t.toDisplayString(n),3)),64))],2),t.createElementVNode("div",{class:t.normalizeClass(e.$style.datesContainer)},[(t.openBlock(!0),t.createElementBlock(t.Fragment,null,t.renderList(R.value,(n,s)=>(t.openBlock(),t.createElementBlock("div",{key:s,class:t.normalizeClass(e.$style.dateRow)},[(t.openBlock(!0),t.createElementBlock(t.Fragment,null,t.renderList(n,o=>(t.openBlock(),t.createElementBlock("div",{key:o.valueOf(),"data-automation-id":"smed-calendar__day-row",class:t.normalizeClass([e.$style.dateCell,J(o)&&e.$style.dateCell_interval,Q(o)])},[t.createElementVNode("div",{"data-automation-id":"smed-calendar__day",class:t.normalizeClass([e.$style.date,e.$style.date_hovered,j(o)&&e.$style.date_current,L(o,t.unref(u))&&e.$style.date_selected,!o.monthSame(l.value)&&e.$style.date_adjacent,C(o)&&e.$style.date_disabled]),onMouseenter:S=>B(o),onMouseleave:a[0]||(a[0]=S=>B(null)),onClick:S=>q(o)},[t.createElementVNode("span",null,t.toDisplayString(o.day),1)],42,x)],2))),128))],2))),128))],2)],64))],2))}}),ae="_container_17mze_1",ne="_container_overflow_17mze_10",le="_monthContainer_17mze_14",oe="_buttonHidden_17mze_21",re="_datesContainer_17mze_26",se="_dateRow_17mze_31",ce="_dateCell_17mze_39",de="_year_17mze_43",ie="_dateCell_intervalStart_17mze_57",me="_dateCell_intervalEnd_17mze_60",ue="_dateCell_intervalSingle_17mze_64",_e="_dateCell_interval_17mze_57",ye="_date_17mze_26",ve="_date_hovered_17mze_94",fe="_date_selected_17mze_108",Ce="_date_disabled_17mze_108",Se="_date_current_17mze_117",he="_date_adjacent_17mze_121",pe="_month_17mze_14",ke="_yearContainer_17mze_136",we="_yearRow_17mze_140",ze="_weekdays_17mze_148",De="_yearItem_17mze_153",ge="_yearItem_selected_17mze_160",Be="_yearItem_current_17mze_163",Me={container:ae,container_overflow:ne,monthContainer:le,buttonHidden:oe,datesContainer:re,dateRow:se,dateCell:ce,year:de,dateCell_intervalStart:ie,dateCell_intervalEnd:me,dateCell_intervalSingle:ue,dateCell_interval:_e,date:ye,date_hovered:ve,date_selected:fe,date_disabled:Ce,date_current:Se,date_adjacent:he,month:pe,yearContainer:ke,yearRow:we,weekdays:ze,yearItem:De,yearItem_selected:ge,yearItem_current:Be},Ee={$style:Me},$e=W._export_sfc(te,[["__cssModules",Ee]]);module.exports=$e;
