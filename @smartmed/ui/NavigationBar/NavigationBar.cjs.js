var ge=require("./NavigationBar.css");const e=require("vue"),S=require("@smartmed/ui/DataList"),b=require("@smartmed/ui/DataListItem"),D=require("@smartmed/ui/DropdownHost"),q=require("@smartmed/ui/Scrollbar"),z=require("@smartmed/ui/SearchInput"),N=require("vue-router"),F=require("../NavigationBar.props-9ec64db6.js"),y=require("@smartmed/ui/SvgIcon"),L=require("@smartmed/ui/tokens"),g=require("@smartmed/ui/Tooltip"),V=require("@smartmed/utility/directives"),R=require("@smartmed/utility/functions"),$=require("../_plugin-vue_export-helper-f246444f.js"),w=e.defineComponent({__name:"EmitRouteActive",props:{to:{}},emits:["active"],setup(f,{emit:v}){const d=f,n=N.useLink(d);return e.watch(n.isActive,i=>{i&&v("active",i)},{immediate:!0}),(i,u)=>(e.openBlock(),e.createElementBlock("span",null,[e.renderSlot(i.$slots,"default")]))}}),T=["tabindex"],O=e.defineComponent({__name:"NavigationChild",props:{section:{}},emits:["active"],setup(f,{emit:v}){const d=f,{section:n}=e.toRefs(d),i=e.ref(!1),u=l=>"children"in l&&l.children.length>0,_=()=>{m.value||(i.value=!i.value)},a=(l,p)=>{i.value=l,v("active",`smed-navigation_${p}`)},h=e.computed(()=>{const l=n.value;return u(l)}),m=e.computed(()=>{const l=n.value;return typeof l.disabled=="string"||!!l.disabled});return(l,p)=>{const k=e.resolveComponent("router-link");return e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(l.$style.root)},[!e.unref(n).to||m.value?(e.openBlock(),e.createBlock(e.unref(g),{key:0,wide:""},{hint:e.withCtx(()=>[typeof e.unref(n).disabled=="string"?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[e.createTextVNode(e.toDisplayString(e.unref(n).disabled),1)],64)):e.createCommentVNode("",!0)]),default:e.withCtx(()=>[e.withDirectives((e.openBlock(),e.createElementBlock("button",{tabindex:m.value?"-1":0,class:e.normalizeClass([l.$style.button,l.$style.title,m.value&&l.$style.title_disabled]),onClick:_},[h.value?(e.openBlock(),e.createBlock(e.unref(y),{key:0,name:"arrow-right",class:e.normalizeClass(["smed-space_right-1",l.$style.icon,i.value&&l.$style.icon_rotate]),size:"sm"},null,8,["class"])):e.createCommentVNode("",!0),e.createElementVNode("span",null,e.toDisplayString(e.unref(n).title),1)],10,T)),[[e.unref(V.KeyboardFocusedDirective)]])]),_:1})):(e.openBlock(),e.createBlock(k,{key:1,id:`smed-navigation_${e.unref(n).title}`,class:e.normalizeClass([l.$style.title,l.$style.title_to]),to:e.unref(n).to,"active-class":l.$style.title_active},{default:e.withCtx(()=>[e.createVNode(w,{to:e.unref(n).to,onActive:p[0]||(p[0]=o=>a(o,e.unref(n).title))},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(e.unref(n).title),1)]),_:1},8,["to"])]),_:1},8,["id","class","to","active-class"])),e.withDirectives(e.createElementVNode("div",{class:e.normalizeClass(l.$style.children)},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(n).children,o=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:o.title},[o.disabled?(e.openBlock(),e.createBlock(e.unref(g),{key:1},{hint:e.withCtx(()=>[typeof o.disabled=="string"?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[e.createTextVNode(e.toDisplayString(o.disabled),1)],64)):e.createCommentVNode("",!0)]),default:e.withCtx(()=>[e.createElementVNode("span",{class:e.normalizeClass([l.$style.children__item,l.$style.children__item_disabled])},e.toDisplayString(o.title),3)]),_:2},1024)):(e.openBlock(),e.createBlock(k,{key:0,id:`smed-navigation_${o.title}`,class:e.normalizeClass(l.$style.children__item),to:o.to,"active-class":l.$style.children__item_active},{default:e.withCtx(()=>[e.createVNode(w,{to:o.to,onActive:t=>a(t,o.title)},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(o.title),1)]),_:2},1032,["to","onActive"])]),_:2},1032,["id","class","to","active-class"]))],64))),128))],2),[[e.vShow,h.value&&i.value]])],2)}}}),A="_root_1yrhl_1",K="_button_1yrhl_12",x="_title_1yrhl_25",I="_title_active_1yrhl_37",M="_title_disabled_1yrhl_37",U="_title_to_1yrhl_40",H="_children_1yrhl_61",j="_children__item_1yrhl_78",P="_children__item_active_1yrhl_88",G="_children__item_disabled_1yrhl_88",J="_icon_1yrhl_102",Q="_icon_rotate_1yrhl_105",W={root:A,button:K,title:x,title_active:I,title_disabled:M,title_to:U,children:H,children__item:j,children__item_active:P,children__item_disabled:G,icon:J,icon_rotate:Q},X={$style:W},Y=$._export_sfc(O,[["__cssModules",X]]),Z=["tabindex"],ee={class:"smed-text_medium"},te={class:"smed-text_medium"},oe=e.defineComponent({__name:"NavigationSection",props:{section:{}},setup(f){const v=f,d=e.inject(L.SCROLLBAR_REF_TOKEN,e.ref(null)),{section:n}=e.toRefs(v),i=e.ref(!1),u=e.ref(null),_=e.computed(()=>{const o=n.value;return"children"in o&&o.children.length>0}),a=e.computed(()=>{const o=n.value;return typeof o.disabled=="string"||!!o.disabled}),h=e.computed(()=>{const o=n.value;return"children"in o?o.children.sort((t,c)=>t.title<c.title?-1:1):[]}),m=()=>{a.value||(i.value=!i.value)},l=o=>{i.value=!0,u.value=o},p=R.useDebounceFn(o=>{const t=document.querySelector(`#${o}`);t==null||t.scrollIntoView({behavior:"smooth",block:"center"})},500);let k=!1;return e.watch([u,d],([o,t])=>{o&&t&&!k&&(k=!0,p(o))}),(o,t)=>{const c=e.resolveComponent("router-link");return e.openBlock(),e.createElementBlock("div",null,[!e.unref(n).to||a.value?(e.openBlock(),e.createBlock(e.unref(g),{key:0,wide:""},{hint:e.withCtx(()=>[typeof e.unref(n).disabled=="string"?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[e.createTextVNode(e.toDisplayString(e.unref(n).disabled),1)],64)):e.createCommentVNode("",!0)]),default:e.withCtx(()=>[e.withDirectives((e.openBlock(),e.createElementBlock("button",{tabindex:a.value?"-1":0,class:e.normalizeClass([o.$style.section,a.value&&o.$style.section_disabled]),onClick:m},[e.createElementVNode("div",{class:e.normalizeClass(o.$style.title)},[typeof e.unref(n).icon=="string"?(e.openBlock(),e.createBlock(e.unref(y),{key:0,name:e.unref(n).icon,class:e.normalizeClass(o.$style.icon)},null,8,["name","class"])):e.unref(n).icon?(e.openBlock(),e.createBlock(e.resolveDynamicComponent(e.unref(n).icon),{key:1})):e.createCommentVNode("",!0),e.createElementVNode("span",ee,e.toDisplayString(e.unref(n).title),1)],2),_.value?(e.openBlock(),e.createBlock(e.unref(y),{key:0,name:"arrow-down",rotate:i.value},null,8,["rotate"])):e.createCommentVNode("",!0)],10,Z)),[[e.unref(V.KeyboardFocusedDirective)]])]),_:1})):(e.openBlock(),e.createBlock(c,{key:1,class:e.normalizeClass(o.$style.section),to:e.unref(n).to,"active-class":o.$style.section_active},{default:e.withCtx(()=>[e.createElementVNode("div",{class:e.normalizeClass(o.$style.title)},[typeof e.unref(n).icon=="string"?(e.openBlock(),e.createBlock(e.unref(y),{key:0,name:e.unref(n).icon,class:e.normalizeClass(o.$style.icon)},null,8,["name","class"])):e.unref(n).icon?(e.openBlock(),e.createBlock(e.resolveDynamicComponent(e.unref(n).icon),{key:1})):e.createCommentVNode("",!0),e.createElementVNode("span",te,e.toDisplayString(e.unref(n).title),1)],2),e.createVNode(e.unref(y),{name:"arrow-right"})]),_:1},8,["class","to","active-class"])),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(h.value,s=>e.withDirectives((e.openBlock(),e.createBlock(Y,{key:s.title,section:s,onActive:l},null,8,["section"])),[[e.vShow,_.value&&i.value]])),128))])}}}),ne="_section_ifq57_1",le="_section_disabled_ifq57_22",se="_section_active_ifq57_25",re="_title_ifq57_42",ie="_icon_ifq57_49",ce={section:ne,section_disabled:le,section_active:se,title:re,icon:ie},ae={$style:ce},ue=$._export_sfc(oe,[["__cssModules",ae]]),de=e.defineComponent({__name:"NavigationBar",props:e.mergeDefaults({sections:{},autofocusOnSearch:{type:Boolean}},F.NavigationBarDefaultProps),setup(f){const v=f,{sections:d,autofocusOnSearch:n}=e.toRefs(v),i=N.useRouter(),u=e.ref(""),_=e.ref(null),a=e.ref(!1),h=t=>{if("children"in t){const c=[];return t.children.forEach(s=>{s.disabled||("to"in s?c.push(s):c.push(...h(s)))}),c}return[]},m=e.computed(()=>{const t=[];return d.value.forEach(s=>{if(!s.disabled)if(!("children"in s))t.push(s);else{const r=h(s);if(r.length===0)return;t.push({title:s.title,children:r})}}),t.sort((s,r)=>s.title<r.title?-1:1)}),l=e.computed(()=>{const t=m.value,c=u.value;if(!c)return t;if(typeof c=="string"){const s=c.toLowerCase();return t.map(r=>"children"in r?{...r,children:r.children.filter(({title:B})=>B.toLowerCase().includes(s))}:r.title.toLowerCase().includes(s)?r:null).filter(Boolean).filter(r=>r.children.length>0)}return t}),p=e.computed(()=>l.value.map(({title:t})=>t));e.watch(u,t=>{typeof t=="string"&&(a.value=!!t)});const k=t=>{typeof t=="string"||!t?u.value=t:(i.push(t.to),a.value=!1,u.value="")},o=()=>{var t;a.value=!1,(t=_.value)==null||t.focus()};return e.onMounted(()=>{n.value&&setTimeout(()=>{var t;(t=_.value)==null||t.focus()})}),(t,c)=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(t.$style.container)},[e.createElementVNode("div",{class:e.normalizeClass(["smed-space_bottom-6",t.$style.header])},[e.renderSlot(t.$slots,"header"),e.createVNode(e.unref(D),{modelValue:a.value,"onUpdate:modelValue":c[1]||(c[1]=s=>a.value=s)},{dropdown:e.withCtx(()=>[e.createVNode(e.unref(S),{"model-value":u.value,items:p.value,"onUpdate:modelValue":k},{list:e.withCtx(({onUpdate:s})=>[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(l.value,(r,B)=>(e.openBlock(),e.createElementBlock("div",{key:B,class:e.normalizeClass([t.$style.items,"children"in r?t.$style.items_list:t.$style.items_single])},["children"in r?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[e.createElementVNode("p",{class:e.normalizeClass(t.$style.items__label)},e.toDisplayString(r.title),3),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(r.children,(C,E)=>(e.openBlock(),e.createBlock(e.unref(b),{key:`${B}_${E}`,onOnClick:Ce=>s(C),onKeydown:e.withKeys(o,["esc"])},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(C.title),1)]),_:2},1032,["onOnClick","onKeydown"]))),128))],64)):(e.openBlock(),e.createBlock(e.unref(b),{key:1,onOnClick:C=>s(r),onKeydown:e.withKeys(o,["esc"])},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(r.title),1)]),_:2},1032,["onOnClick","onKeydown"]))],2))),128))]),_:1},8,["model-value","items"])]),default:e.withCtx(()=>[e.createVNode(e.unref(z),{modelValue:u.value,"onUpdate:modelValue":c[0]||(c[0]=s=>u.value=s),ref_key:"searchRef",ref:_,placeholder:"Поиск по разделам","pseudo-focused":a.value},null,8,["modelValue","pseudo-focused"])]),_:1},8,["modelValue"])],2),e.createVNode(e.unref(q),null,{default:e.withCtx(()=>[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(d),(s,r)=>(e.openBlock(),e.createBlock(ue,{key:r,section:s},null,8,["section"]))),128))]),_:1}),e.renderSlot(t.$slots,"footer")],2))}}),_e="_container_11d0l_1",me="_header_11d0l_10",pe="_items_11d0l_17",fe="_items_list_11d0l_20",ve="_items_single_11d0l_20",he="_items__label_11d0l_32",ke={container:_e,header:me,items:pe,items_list:fe,items_single:ve,items__label:he},ye={$style:ke},Be=$._export_sfc(de,[["__cssModules",ye]]);module.exports=Be;
