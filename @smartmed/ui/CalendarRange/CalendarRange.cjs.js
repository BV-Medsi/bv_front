var J=require("./CalendarRange.css");const n=require("vue"),w=require("@smartmed/ui/Calendar"),I=require("@smartmed/ui/DataList"),m=require("@smartmed/utility/date"),$=require("../_plugin-vue_export-helper-f246444f.js"),z={min:()=>m.SMED_FIRST_DAY,max:()=>m.SMED_LAST_DAY,defaultViewedMonth:()=>m.SmedMonth.currentLocal(),periods:()=>[]},H=n.defineComponent({name:"CalendarRange",__name:"CalendarRange",props:n.mergeDefaults({modelValue:{},min:{},max:{},defaultViewedMonth:{},disabledDatesHandler:{type:Function},periods:{}},z),emits:["update:modelValue"],setup(S,{emit:v}){const g=S,{modelValue:h,max:l,min:u,defaultViewedMonth:d,periods:p}=n.toRefs(g),a=n.ref(h.value),i=n.ref(null),f=n.computed(()=>d.value.append({month:1})),s=n.ref(d.value),r=n.ref(f.value),c=n.computed(()=>p.value.length>0),M=n.computed(()=>{const e=a.value;if(e===null)return null;const t=u.value,o=l.value;return p.value.find(({range:V})=>e.from.daySame(V.from.dayLimit(t,o))&&e.to.daySame(V.to.dayLimit(t,o)))||null}),b=n.computed(()=>[].concat(p.value).concat("Другая дата")),x=n.computed(()=>{if(c.value){const e=a.value;return e?e.to:d.value}return s.value}),D=n.computed(()=>c.value?void 0:k.value.append({month:-1})),C=n.computed(()=>B.value.append({month:1})),B=n.computed(()=>{const e=s.value,t=r.value;return e.monthSameOrBefore(t)?e:t}),k=n.computed(()=>{const e=l.value,t=r.value;return t.monthBefore(e)?t:e}),F=(e,t)=>{const o=M.value;return typeof t=="string"&&o===null?!0:o===t},_=e=>{const t=a.value;if(t===null||!t.isSingleDay){a.value=new m.SmedDayRange(e,e);return}const o=m.SmedDayRange.sort(t.from,e);a.value=o,v("update:modelValue",o)},R=e=>{s.value=e,r.value=e.append({month:1})},L=e=>{s.value=e.append({month:-1}),r.value=e},P=e=>{if(typeof e!="string"){const t=e.range,o=u.value,y=l.value;v("update:modelValue",t.dayLimit(o,y));return}M.value!==null&&v("update:modelValue",null)},U=e=>{const t=e===null?d.value:e.from;s.value=t,r.value=t.append({month:1})},j=e=>{const t=l.value;if(e.monthSameOrAfter(t))return t;const o=u.value;return e.monthBefore(o)?o.append({month:1}):e},q=(e,t)=>{if(e.monthSameOrAfter(t))return t.append({month:-1});const o=u.value;return e.monthSameOrBefore(o)?o:e},A=()=>{if(!a.value){const e=j(f.value);r.value=e,s.value=q(d.value,e)}};return n.onMounted(()=>{A()}),n.watch(h,e=>{(!a.value&&e||a.value&&!(e!=null&&e.daySame(a.value)))&&(a.value=e,U(e)),a.value=e},{immediate:!0}),(e,t)=>(n.openBlock(),n.createElementBlock("div",{class:n.normalizeClass(e.$style.root)},[n.createVNode(n.unref(w),{"hovered-item":i.value,"onUpdate:hoveredItem":t[0]||(t[0]=o=>i.value=o),"show-adjacent-days":c.value,min:n.unref(u),max:n.unref(l),month:x.value,"max-viewed-month":D.value,"disabled-dates-handler":e.disabledDatesHandler,value:a.value,onDayClick:_,"onUpdate:month":R},null,8,["hovered-item","show-adjacent-days","min","max","month","max-viewed-month","disabled-dates-handler","value"]),c.value?(n.openBlock(),n.createBlock(n.unref(I),{key:1,size:"lg",class:n.normalizeClass([e.$style.border,e.$style.list]),"model-value":a.value,items:b.value,matcher:F,"onUpdate:modelValue":P},null,8,["class","model-value","items"])):(n.openBlock(),n.createBlock(n.unref(w),{key:0,"hovered-item":i.value,"onUpdate:hoveredItem":t[1]||(t[1]=o=>i.value=o),class:n.normalizeClass(e.$style.border),min:n.unref(u),max:n.unref(l),month:r.value,"min-viewed-month":C.value,"disabled-dates-handler":e.disabledDatesHandler,value:a.value,onDayClick:_,"onUpdate:month":L},null,8,["hovered-item","class","min","max","month","min-viewed-month","disabled-dates-handler","value"]))],2))}}),O="_root_110mj_1",E="_border_110mj_5",T="_list_110mj_9",Y={root:O,border:E,list:T},N={$style:Y},G=$._export_sfc(H,[["__cssModules",N]]);module.exports=G;
