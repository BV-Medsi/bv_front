var ue=require("./InputDateRange.css");const e=require("vue"),F=require("@maskito/kit"),L=require("@smartmed/ui/BaseInput"),G=require("@smartmed/ui/CalendarMobile"),U=require("@smartmed/ui/CalendarRange"),K=require("@smartmed/ui/DropdownHost"),X=require("@smartmed/ui/Popup"),Y=require("@smartmed/ui/SvgIcon"),S=require("@smartmed/ui/tokens"),v=require("@smartmed/ui/use"),t=require("@smartmed/utility/date"),I=require("@smartmed/utility/vue"),j=require("../BaseInput.props-4886ef7a.js"),W=require("../_plugin-vue_export-helper-f246444f.js"),J={...j.BaseInputDefaultProps,hasCleaner:!0,inputmode:"numeric",placeholder:t.DATE_RANGE_POSTFIX_DECORATOR,dropdownProps:()=>({}),calendarRangeProps:()=>({}),min:()=>t.SMED_FIRST_DAY,max:()=>t.SMED_LAST_DAY,periods:()=>[],disabledDatesHandler:()=>!1},Q={key:0},Z=e.defineComponent({name:"InputDateRange",__name:"InputDateRange",props:e.mergeDefaults({modelValue:{},modelModifiers:{},type:{},size:{},disabled:{type:Boolean},label:{},description:{},editable:{type:Boolean},isError:{type:Boolean},isSuccess:{type:Boolean},placeholder:{},autocomplete:{},name:{},hasCleaner:{type:Boolean},decoratorPostfix:{},decoratorPostfixColorClass:{},inputmode:{},readonly:{type:Boolean},stringify:{type:Function},id:{},dataAutomationId:{},pseudoHovered:{type:Boolean},pseudoFocused:{type:Boolean},inputStyles:{},rightSlotPadding:{},max:{},min:{},periods:{},dropdownProps:{},disabledDatesHandler:{type:Function},calendarRangeProps:{}},J),emits:["update:modelValue"],setup(x,{emit:s}){const D=x,{modelValue:u,disabled:E,isError:k,max:i,min:c,periods:m}=e.toRefs(D),p=e.inject(S.IS_POPUP_MOBILE_TOKEN,e.ref(!1)),n=e.ref(!1),r=e.ref(!1),C=e.ref(null),w=e.computed(()=>{var o;return((o=C.value)==null?void 0:o.wrapper)??null});e.provide(S.DROPDOWN_HOST_PIVOT_TOKEN,w);const _=e.useSlots(),y=v.useControlAccess(null),B=v.useControlInvalid(k),h=v.useControlDisabled(E),f=o=>(o==null?void 0:o.toString())||"",d=e.ref(f(u.value)),N=e.computed(()=>I.hasSlotContent(_.label)),A=e.computed(()=>I.hasSlotContent(_.description)),g=e.computed(()=>m.value.length>0),P=e.computed(()=>{const o=u.value;if(o===null)return null;const a=c.value,l=i.value;return m.value.find(({range:b})=>o.from.daySame(b.from.dayLimit(a,l))&&o.to.daySame(b.to.dayLimit(a,l)))||null}),V=e.computed(()=>{const o=P.value;return o?(o.range.isSingleDay?o.range:"")?`${o} (${o.range.from})`:o:""}),O=e.computed(()=>{const o=i.value.toLocalNativeDate(),a=c.value.toLocalNativeDate();return F.maskitoDateRangeOptionsGenerator({mode:"dd/mm/yyyy",separator:".",max:o,min:a})}),R=e.computed(()=>{const o=d.value;return t.DATE_RANGE_POSTFIX_DECORATOR.slice(o.length)}),T=o=>{n.value=!1,!(o instanceof t.SmedDay)&&s("update:modelValue",o)},q=()=>{n.value=!1},H=o=>{s("update:modelValue",o),r.value=!1},M=o=>{const a=o;if(d.value=a,!a){s("update:modelValue",null);return}a.length===t.DATE_RANGE_FILTER_LENGTH&&s("update:modelValue",t.SmedDayRange.normalizeParse(a))},$=o=>{p.value&&(o.stopPropagation(),o.preventDefault(),n.value=!n.value)},z=()=>{s("update:modelValue",null),r.value=!0};return e.watch(r,o=>{!o&&y&&y.markAsTouch()}),e.watch(u,o=>{f(o)===d.value||(d.value=f(o))}),(o,a)=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(o.$style.idrHost)},[e.createVNode(e.unref(K),e.mergeProps(o.dropdownProps,{modelValue:r.value,"onUpdate:modelValue":a[0]||(a[0]=l=>r.value=l),class:o.$style.idrHost,"max-width":266*2,"min-width":266*2,"min-height":g.value?330:318,"can-open":!e.unref(p)&&!e.unref(h)}),{dropdown:e.withCtx(()=>[e.createVNode(e.unref(U),e.mergeProps(o.calendarRangeProps,{max:e.unref(i),min:e.unref(c),periods:e.unref(m),"model-value":e.unref(u),"disabled-dates-handler":o.disabledDatesHandler,"onUpdate:modelValue":H}),null,16,["max","min","periods","model-value","disabled-dates-handler"])]),default:e.withCtx(()=>[e.createVNode(e.unref(L),e.mergeProps(D,{ref_key:"baseInputExposed",ref:C,disabled:e.unref(h),"model-value":d.value,"is-error":e.unref(B),"pseudo-focused":!e.unref(p)&&r.value,"mask-options":O.value,"decorator-postfix":R.value,"decorator-postfix-color-class":o.$style.idrDecorator,onSearchClear:z,"onUpdate:modelValue":M}),{right:e.withCtx(()=>[e.createVNode(e.unref(Y),{name:"calendar",class:e.normalizeClass(o.$style.idrIcon),size:o.size==="sm"?"md":"lg",onClick:$},null,8,["class","size"])]),label:e.withCtx(()=>[N.value?e.renderSlot(o.$slots,"label",{key:0}):e.createCommentVNode("",!0)]),description:e.withCtx(()=>[A.value?e.renderSlot(o.$slots,"description",{key:0}):e.createCommentVNode("",!0)]),valueContent:e.withCtx(()=>[g.value&&P.value&&V.value?(e.openBlock(),e.createElementBlock("span",Q,e.toDisplayString(V.value),1)):e.createCommentVNode("",!0)]),_:3},16,["disabled","model-value","is-error","pseudo-focused","mask-options","decorator-postfix","decorator-postfix-color-class"])]),_:3},16,["modelValue","class","min-height","can-open"]),e.unref(p)?(e.openBlock(),e.createBlock(e.unref(X),{key:0,modelValue:n.value,"onUpdate:modelValue":a[1]||(a[1]=l=>n.value=l),size:"full",closable:!1},{default:e.withCtx(()=>[e.createVNode(e.unref(G),{"actions-fixed":"",value:e.unref(u),single:!1,class:e.normalizeClass(o.$style.calendar),min:e.unref(c),max:e.unref(i),"disabled-dates-handler":o.disabledDatesHandler,onConfirm:T,onCancel:q},null,8,["value","class","min","max","disabled-dates-handler"])]),_:1},8,["modelValue"])):e.createCommentVNode("",!0)],2))}}),ee="_idrHost_mcetu_1",oe="_idrIcon_mcetu_5",ae="_idrDecorator_mcetu_13",te="_calendar_mcetu_17",ne={idrHost:ee,idrIcon:oe,idrDecorator:ae,calendar:te},re={$style:ne},le=W._export_sfc(Z,[["__cssModules",re]]);module.exports=le;
